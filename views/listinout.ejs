<% include header.ejs %>

<!-- page content -->
<script>

function ConvertToUnit(qte, unittype){

    if (unittype == "Boîte"){
      return Number(qte) * 21;
    }else if (unittype == "Caisse"){
      return Number(qte) * 6 * 21;
    }else if(unittype == "Unité"){
      return Number(qte);
    }



}


</script>

<div class="right_col" role="main">
  <div class="">



    <div class="row">

      <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
    <h2>Liste des Entrées / Sorties<small>Gestion de Stock</small></h2>
      <div class="pull-right">
        <a class="btn btn-primary btn-md" href="/stockin" role="button"><i class="fa fa-plus"></i>   Nouvelle entrée</a>
        <a class="btn btn-danger btn-md" href="/adddepot" role="button"><i class="fa fa-plus"></i>   Nouvelle sortie</a>
      </div>



    <div class="clearfix"></div>
  </div>

          <div class="x_content">

<div class="table-responsive">
<!--    <table class="table table-striped jambo_table bulk_action"> -->
  <table id="datatable-checkbox" class="table table-striped table-bordered bulk_action">
    <thead>
      <tr class="headings">

        <th class="column-title">Dépôt</th>
        <th class="column-title">Code produit</th>
        <th class="column-title">Désignation produit</th>
        <th class="column-title">Date Achat</th>
        <th class="column-title">Qté Initiale</th>
        <th class="column-title">Total Sortie</th>
        <th class="column-title">Stock actuel</th>
        <th class="column-title">Date expiration</th>
        <th class="column-title">Date Saisie</th>


        <th class="column-title no-link last"><span class="nobr">Action</span>
        </th>
        <th class="bulk-actions" colspan="7">
          <a class="antoo" style="color:#fff; font-weight:500;">Bulk Actions ( <span class="action-cnt"> </span> ) <i class="fa fa-chevron-down"></i></a>
        </th>
      </tr>
    </thead>
    <tbody>

      <% for (var i = 0; i < depots.length; i++) {%>
        <% for (var j = 0; j< depots[i].inout.length; j++) {%>

<tr class="even pointer">

  <td class=" "><%= depots[i].depotname %></td>
  <td class=" "><%= depots[i].inout[j].prodcode %></td>
  <% for(var l = 0; l < prods.length; l++){%>
    <% if (depots[i].inout[j].prodcode == prods[l].prodcode){%>
      <td class=" "><%= prods[l].prodname %> </td>
    <%}%>

  <%}%>

  <td class=" "><%= depots[i].inout[j].dateachat %></td>
  <td class=" "><%= depots[i].inout[j].prodqteinit %> <%= depots[i].inout[j].produnite %> (<script>
    document.write(ConvertToUnit(<%= depots[i].inout[j].prodqteinit %>, "<%= depots[i].inout[j].produnite %>"));
  </script> Unités)</td>
  <td class=" "><script>
        document.write(ConvertToUnit(<%= depots[i].inout[j].prodqteinit %>, "<%= depots[i].inout[j].produnite %>") - Number("<%=depots[i].inout[j].prodqtemv %>") + '  Unités');
  </script>
    </td><!--quantité totale sortie-->
  <td class=" "><%= depots[i].inout[j].prodqtemv %>    Unités</td><!--quantité restante en stock-->
  <td class=" "><%= depots[i].inout[j].dateexp %></td>
  <td class=" "><%= depots[i].inout[j].datein %></td>
  <!--stock alert-->
<!--
  <td class=" "><%= depots[i].depotname %></td>

  <td class=" "><%= depots[i].inout[j].prodcode %></td>

  <td class=" "><%= depots[i].inout[j].produnite %></td>

  <td class=" "><%= depots[i].inout[j].prodqteinit %></td>

  <td class=" "><%= depots[i].inout[j].prodqtemv %></td>

  <td class=" "><%= depots[i].inout[j].dateexp %></td>

-->
<td class=" last"  align='right' width='200px;'>
    <a class="btn btn-info btn-xs" href="#" role="button"><i class="fa fa-pencil"></i> Edit </a>
    <a class="btn btn-primary btn-xs" href="#" role="button"><i class="fa fa-folder"></i> View </a>
    <a class="btn btn-danger btn-xs" onclick="if (confirm('Voulez vous vraiment supprimer ce patient ?')) supprimer('#'); else alert('OK')" href="#"><i class="fa fa-trash-o"></i> Delete </a>

</td>


        <% } %>
      <% } %>

    </tbody>
  </table>
</div>

</div>
</div>
</div>
</div>
</div>
</div>


<!-- /page content -->
<!-- Handling cloture click -->


<script src="../build/js/Helper.js"></script>






<% include footer.ejs %>
